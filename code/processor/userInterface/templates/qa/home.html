{% extends "base.html" %}
{% load mytags %}
{% block content %}

{% block other_css %}
<style>
.form-group { width:100%!important;}
button { width:100%!important;}
.id_qtype { display: none;}
.id_num_col { display: none;}
.mybtn:hover { background-color: #8262B3; color:#FFFFFF;}
.mybtn { background-color: #936FC9; color:#FFFFFF;}
.twitter-typeahead { width:100%; }
</style>
{% endblock other_css %}

<div class="row">
  <div class="col-md-9 col-md-offset-1">
  	<div>
  		Please ask your question below! 
  	</div>
  	<br/>
<ul id="myTab" class="nav nav-tabs">
  <li class="active"><a class="topic" id="personTabLink" data-toggle="tab">Person</a></li>
  <li><a class="topic" id="placesTabLink" data-toggle="tab">Places</a></li>
  <li><a class="topic" id="moviesTabLink" data-toggle="tab">Movies</a></li>
</ul>
</div>
</div>

<div id="myTabContent" class="tab-content">
  	<form style="margin-top:30px" class="form-inline" role="form" action="" id="PersonForm" method="POST">{% csrf_token %}
      <div class="row">
      {% for field in form %}
        {% ifequal forloop.counter 2 %}
        <div class="col-md-2 col-md-offset-1 {{field.id_for_label}}">
        {% else %}
            {% ifequal forloop.counter 4 %}
                <div class="col-md-3 {{field.id_for_label}}">
            {% else %}
                <div class="col-md-2 {{field.id_for_label}}">
            {% endifequal %}
        {% endifequal %}
          {% if field.errors %}
              <div class="form-group has-error">
          {% else %}
              <div class="form-group">
          {% endif %}
                   <label for="{{ field.id_for_label }}" class="sr-only">{{ field.choice_label }}</label>
                   {{ field }}
                   {% if field.errors %}
                            {{field.errors|striptags}}
                   {% endif %}
              </div>
        </div>
      {% endfor %}
      </div>
      <div class="row top-buffer">
        <div class="col-md-2 col-md-offset-8">
  	      <button type="submit" class="btn btn-default mybtn">Search</button>
        </div>
      </div>

    </form>
</div>
{% endblock content %}

{% block other_js %}
<script type="text/javascript">
$('.topic').click(function (e) {
  //e.preventDefault();
  //var id = $(this).attr('id');
  var id = this.id;
  alert(id);
})
//{% if form.errors %}
    //alert("ASDF");
    //{% for field in form %}
        //alert("{{field.errors}}");
    //{% endfor %}
//{% endif %}
$('.qtype').hide();
//var callback = function(data){
 //                 alert("YES");
  //                alert(data);
   //               alert(data.spellcheck.suggestions[1].suggestion);
    //              return data;
     //          }
$('input#id_noun').typeahead({
  name: 'noun',
//  local: ['timtrueman', 'JakeHarding', 'vskarich']
  //valueKey: "a.spellcheck.suggestions[1].suggestion",
  remote: {
    //url: "http://localhost:8983/solr/QACollection/suggest?q=name%3A%QUERY&wt=json&indent=true&json.wrf=callback",
    url: "/suggest/q=%QUERY",
    dataType: "json",
    filter: function(data){
      //alert("Filtering results");
      var new_data = JSON.parse(data);
      //alert(new_data);
      var resultList = new_data.spellcheck.suggestions[1].suggestion;
      //alert(resultList);
      return resultList;
    }
  }
  
});
</script>
<script type="text/javascript">
$('#id_fiveW').change(function(e){
  $('#id_col2').empty();
  $('#id_last_col').empty();
  var fiveW_val = $('#id_fiveW').val();
  //alert(fiveW_val);

  var col2_options ={'who':  {"Select--": "",
                            "is": "is",
                            "are": "are",
                            "was": "was"
                            },
                    'where': {"Select--": "",
                              "does": "does",
                              "was": "was",
                              "is": "is"
                              },
                    'when': {"Select--": "",
                             "was": "was",
                             "did": "did"
                             },
                    'what': {'Select--': '',
                             'is': 'is',
                             'was': 'was',
                             'are': 'are'
                             }
                    };
    var this_col2_options = col2_options[fiveW_val];
    $.each(this_col2_options, function(key, value) {
      $('#id_col2').append($("<option></option>")
           .attr("value", value).text(key));
           });
      $('#id_col2').val('');
     var last_col_options = {'Please select in order':''}
     $.each(last_col_options, function(key, value) {
       $('#id_last_col').append($('<option></option>')
           .attr('value', value).text(key));
        });
      $('#id_last_col').val('');
});
$('#id_col2').change(function(e){
  $('#id_last_col').empty();
  var col2_val = $('#id_col2').val();
  var fiveW_val = $('#id_fiveW').val();
  //alert(fiveW_val);

  var last_col_options ={'who':  {'is': {'spouse': 'spouse',
                                         'partner': 'partner',
                                         'employer': 'employer',
                                         'Select--': ''
                                        },
                                  'are': {'family':'family',
                                          'children':'children',
                                         'parents': 'parents',
                                         'Select--':''},
                                  "was": {'spouse': 'spouse',
                                          'Select--':''}
                                  },
                          'where': {"does": {'work':'work',
                                             'live':'live',
                                             'Select--':''
                                            },
                                    "was": {'born':'born',
                                            'Select--':''
                                           },
                                    "is": {'from':'form',
                                           'residence':'residence',
                                           'Select--':''
                                          }
                                    },
                           
                           'when': {'was': {"Select--": "",
                                            "born": "born"
                                           },
                                    'did': {"Select--":"",
                                            "die":"die"
                                           }
                                   },
                    
                            'what': {'is': {'known-for':'knownfor',
                                            'birth-place':'birthplace',
                                            'almamater':'almamater',
                                            'salary': 'salary',
                                            'ethnicity': 'ethnicity',
                                            'nationality': 'nationality',
                                            'height': 'height',
                                            'weight': 'weight', 
                                            'citizenship': 'citizenship',
                                            'fame':'knownfor',
                                            'networth':'networth'
                                            },
                                     'was': {'birth-place':'birthplace',
                                             'Select--':''
                                             },
                                     'are': {'nicknames':'nicknames',
                                             'Select--':'', 
                                             'awards':'awards'
                                             }
                                     }
                            };
    var this_col_options = last_col_options[fiveW_val][col2_val];
    $.each(this_col_options, function(key, value) {
      $('#id_last_col').append($("<option></option>")
           .attr("value", value).text(key));
           });
      $('#id_last_col').val('');
});

</script>

{% endblock other_js %}
